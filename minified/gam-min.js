function runGam(){function e(e){return document.getElementById(e)}function t(e){return document.createElement(e)}function i(e){return document.createTextNode(e)}function l(e,i){let l=t("IMG");void 0!==i&&(l.id=i),l.alt="Click or tap to close",l.classList.add("closeButton"),l.src="http://www.ndhfilms.com/assets/images/closeButton.svg",e.appendChild(l)}let a=e("textarea").value,n=JSON.stringify(a);'"'===n.charAt(0)&&(n=n.slice(1)),n.charAt(n.length-1)&&(n=n.slice(0,n.length-1));let d=n.split("\\n"),s={title:"",subtitle:"",credit:"",author:"",illustrator:"",coverart:"",coverartdesc:"",coverlink:"",kywd:"",copyright:"",location:"",date:"",lang:"",icon:"",desc:"",keywords:"",audio:"",monetizelink:"",monetizeicon:"",small:"",stylesheet:[],menu:"",favorites:""},o=[],c=[],r=[],p="",h=!1,u=[],f=0,C=t("SECTION");C.id="footnoteSection";let g=!0;!function(){let e;function t(t){d[e].slice(0,t.length+2)==="!!"+t&&("SMALL"===t?s.small="small":"STYLESHEET"===t?s.stylesheet.push(d[e].slice(0,12).replace(" ","_")):s[t.toLowerCase()]=d[e].slice(t.length+3))}for(e=0;e<d.length;e+=1)"//"===d[e].slice(0,2)||""===d[e]?(d.splice(e,1),e>=2?e-=2:e=0):"!!"===d[e].slice(0,2)&&(["TITLE","SUBTITLE","CREDIT","AUTHOR","ILLUSTRATOR","COVERART","COVERARTDESC","KYWD","COPYRIGHT","LOCATION","DATE","LANG","ICON","DESC","KEYWORDS","AUDIO","MONETIZELINK","MONETIZEICON","SMALL","STYLESHEET","MENU","FAVORITES"].forEach(t),d.splice(e,1),e>=0?e-=1:0===e&&(e=0))}(),""!==s.monetizelink&&""===s.monetizeicon||""===s.monetizelink&&""!==s.monetizeicon?alert("Missing information for monetization."):""!==s.monetizelink&&""!==s.monetizeicon&&(p=(p=(p="<div id='monetizationDiv' class='buttons'><a href='[monetizationLink]'><img id='monetizationIcon'src='[monetizationIcon]' /></a></div>").replace("[monetizationLink]",s.monetizelink)).replace("[monetizationIcon]",s.monetizeicon)),d.forEach(function(e,t){if(4===e.length)d[t]=e.replace("****","[break]");else{function i(e){if(d[t].includes(e)){let l,a=d[t].indexOf(e)+2,n="";"{{"===e?n=d[t].indexOf("}}"):"[["===e&&(n=d[t].indexOf("]]"));let s="";for(l=a;l<n;l+=1)s=s.concat(d[t][l]);let o=s.split("||"),c="";if("{{"===e){let e=o[0],t=o[1],i="";void 0!==o[2]&&(i=o[2].replace(" ","_"));let l="";void 0!==o[4]&&(l="download"),c="<a target='_blank' [download] id='"+i+"' href='"+e+"'>"+t+"</a>",""===i&&(c=c.replace("id=''","")),c=c.replace("[download]",l),""===l&&"#"!==e.charAt(0)||(c=c.replace("target='_blank'",""))}else if("[["===e){let e=o[0];c="<span id='"+o[1].replace(" ","_")+"'>"+e+"</span>"}"{{"===e?d[t]=d[t].replace(/\{\{([^}]+)\}\}/,c):"[["===e&&(d[t]=d[t].replace(/\[\[([^}]+)\]\]/,c)),i(e)}}e.includes("**")&&(d[t]=e.replace(/\*\*(.*?)\*\*/gm,"<b>$1</b>")),e.includes("*")&&(d[t]=d[t].replace(/\*(.*?)\*/gm,"<i>$1</i>")),i("{{"),i("[[")}});let m=t("HTML"),L="<html lang='[lang]'>";L=""!==s.lang?L.replace("[lang]",s.lang.toLowerCase()):L.replace("[lang]","en");let v=t("BODY");!function(){let e=t("HEAD"),i=t("META");i.httpEquiv="content-type",i.content="text/html; charset=utf-8",e.appendChild(i);let l=t("TITLE"),a=s.title+" "+s.credit+" "+s.author;if(""===s.credit&&(a=s.title+" by "+s.author),0===d.length&&(a="Empty E-Book"),l.text=a,e.appendChild(l),""!==s.author){let i=t("META");i.name="author",i.content=s.author,e.appendChild(i)}if(""!==s.desc){let i=t("META");i.name="description",i.content=s.desc,e.appendChild(i)}if(""!==s.keywords){let i=t("META");i.name="keywords",i.content=s.keywords,e.appendChild(i)}let n=t("META");if(n.name="theme-color",n.content="#fff5ee",e.appendChild(n),""===s.kywd&&""!==s.favorites)alert("WARNING: Designated a favorites-array,but no keyword for e-book");else if(""!==s.kywd&&""===s.favorites)alert("WARNING: Designated a keyword for e-book,but no favorites-array");else if(""!==s.favorites&&""!==s.kywd){let i=t("META");i.name="nameOfFavoritesArray";let l=s.favorites;i.content=l,e.appendChild(i);let a=t("META");a.name="keyword",a.content=s.kywd,e.appendChild(a)}function o(i){let l=t("LINK");l.rel="stylesheet",l.type="text/css",l.href=i,e.appendChild(l)}o("http://www.ndhfilms.com/assets/style/e-readerstyle.css"),s.stylesheet.length>0&&s.stylesheet.forEach(function(e){o(e)});let c=t("LINK");c.rel="icon",c.type="image/gif";let r="http://www.ndhfilms.com/assets/images/walkingfavicon.gif";""!==s.icon&&(r=s.icon),c.href=r,e.appendChild(c);let p=t("LINK");p.rel="apple-touch-icon",p.sizes="57x57",p.href=r,e.appendChild(p);let h=t("LINK");h.rel="apple-touch-icon",h.sizes="180x180",h.href=r,e.appendChild(h),m.appendChild(e)}();let I=t("P");I.id="darkModeStorage",v.appendChild(I),function(){let e=t("HEADER"),l=t("HGROUP");if(""!==s.title){let e=t("H1");e.id="title";let a=i(s.title);e.appendChild(a),l.appendChild(e)}if(""!==s.subtitle){let e=t("H2");e.id="subtitle";let a=i(s.subtitle);e.appendChild(a),l.appendChild(e)}if(""!==s.author){let e=t("H2");""===s.credit&&(s.credit="By");let a=i(s.credit+" "+s.author);e.appendChild(a),l.appendChild(e)}if(""!==s.illustrator){let e=t("H3"),a=i("Illustrated by "+s.illustrator);e.appendChild(a),l.appendChild(e)}if(""!==s.coverart){let e=t("H3"),a=i("Cover Art by "+s.coverart);e.appendChild(a),l.appendChild(e)}e.appendChild(l),v.appendChild(e)}(),function(){let e=t("DIV");e.classList.add("menuClosed"),e.id="buttonContainer";let i=["<div id='menuIconDiv' class='buttons' onclick=''><img id='menuIconImg' alt='Click or tap to toggle menu'src='http://www.ndhfilms.com/assets/images/menuicon_black.svg' /></div>","<div id='tocIconDiv' class='buttons' onclick=''><object id='tocIconObject'type='image/svg+xml'data='http://www.ndhfilms.com/assets/images/tocicon.svg'>Your browser does not support SVG</object></div>","<div id='lightbulbDiv' class=' buttons' onclick=''><object ID='lightbulbObject'type='image/svg+xml'data='http://www.ndhfilms.com/assets/images/lightbulb.svg'>Your browser does not support SVG</object></div>","<div id='bookmarkDiv'class='buttons'><object id='bookmarkObject' type='image/svg+xml'data='http://www.ndhfilms.com/assets/images/bookmark.svg'>Your browser does not support SVG</object></div>","<div id='cassetteDiv' class='buttons'><object id='cassetteObject' type='image/svg+xml'data='http://www.ndhfilms.com/assets/images/cassette.svg'>Your browser does not support SVG</object></div>"];""!==p&&i.push(p),""!==s.favorites&&i.push("<div id='starDiv' class='buttons'><object id='starObject' type='image/svg+xml' data='../../assets/images/star.svg'>Your browser does not support SVG</object></div>");let l="";i.forEach(function(e){l=l.concat(e)}),e.innerHTML=l,v.appendChild(e)}(),""!==s.audio&&function(){let e=t("DIV");e.id="audioDiv",e.classList.add("standby");let a={},n=s.audio.split(" ");n.forEach(function(e,t){if(":background"===e)a.background=n[t+1];else if(":copyright"===e){let e=n.slice(t+1).join(" ");a.copyright=e}});let d=t("DIV");d.id="audioBackground",void 0!==a.background&&(d.style.backgroundImage="url('"+a.background+"')"),e.appendChild(d);let o=t("DIV");o.id="audioContainer",o.classList.add("container");let c=t("DIV");c.id="audioIllustrationDiv",c.classList.add("flexbox1");let r=t("IMG");r.id="audioDivIllustration",c.appendChild(r);let p=t("HGROUP");p.classList.add("audioInfoHgroup");let h=t("H1"),u=i(s.title);h.appendChild(u),p.appendChild(h);let f=t("H2"),C=i(s.credit+" "+s.author);f.appendChild(C),p.appendChild(f);let g=t("H2");if(""!==a.copyright){let e="";e="public"===a.copyright.slice(0,6).toLowerCase()?"Audio Recording <s>&COPY</s> "+a.copyright:"Audio Recording &COPY; "+a.copyright,g.innerHTML=e,p.appendChild(g)}let m=t("H3"),L=t("A");L.id="audioCreditsLink",L.href="#creditsSection",L.onclick=!0;let I=i("CREDITS");L.appendChild(I),m.appendChild(L),p.appendChild(m),c.appendChild(p),o.appendChild(c);let T=t("DIV");T.id="audioCassetteDiv",T.classList.add("flexbox2");let b=t("DIV");b.id="cassetteAnimatedDiv";let E=t("OBJECT");E.id="cassetteAnimatedObject",E.type="image/svg+xml",E.data="http://www.ndhfilms.com/assets/images/cassetteAnimated.svg",b.appendChild(E),T.appendChild(b);let y=t("DIV");y.id="audioInterfaceWrapper",y.innerHTML="<object id='audioElement'type='image/svg+xml'data='http://www.ndhfilms.com/assets/images/audiointerface.svg'>Your browser does not support SVG</object></div>",T.appendChild(y),o.appendChild(T),e.appendChild(o),l(e,"audioCloseButton"),v.appendChild(e)}(),function(){let e=0;d.forEach(function(a,n){if("[break]"===a){let e=t("HR");e.classList.add("style-two"),v.appendChild(e)}else if("@@COVERIMG"===a.slice(0,10)){let e=t("A");s.coverlink=a.slice(11),e.href=s.coverlink;let i=t("IMG");i.id="coverImg",""!==s.coverartdesc?(i.title=s.coverartdesc,i.alt=s.coverartdesc):(i.title="Cover of "+s.title,i.alt="Cover of "+s.title,""!==s.coverart&&(i.title=i.title.concat(" by "+s.coverart),i.alt=i.alt.concat(" by "+s.coverart))),i.src=s.coverlink,e.appendChild(i),v.insertBefore(e,v.childNodes[0]),o.push({link:"#coverImg",text:"Cover"})}else if("@@BLOCKQ"===a.slice(0,8)){let e=a.slice(8);e=e.replace(/\\"/g,'"');let l=t("BLOCKQUOTE"),n=i(e);l.appendChild(n),v.appendChild(l)}else if("@@QUOTEATTR"===a.slice(0,11)){let e=" - "+a.slice(11);e=e.replace(/\\"/g,'"');let l=t("P");if(l.classList.add("blockquoteAttr"),e.includes("<i>"))l.innerHTML=e;else{let t=i(e);l.appendChild(t)}v.appendChild(l)}else if("@@SUPPORT"===a.slice(0,9)){let e=a.slice(9).split(" ");if(!1===e.includes(":title")||!1===e.includes(":text"))return void alert("@@SUPPORT section is missing required information");let l={title:"",text:""};e.forEach(function(t,i){let a="",n="",d=0;if(":title"===t){for(d=i+1;d<e.indexOf(":text");d+=1)a=a.concat(" "+e[d]);d=0,l.title=a}else if(":text"===t){for(d=i+1;d<e.length;d+=1)n=n.concat(" "+e[d]);d=0,l.text=n}});let n=t("SECTION");n.classList.add("endingSection"),n.id="supportSection";let d=t("H3");d.classList.add("sectionHeader");let s=i(l.title);d.appendChild(s),n.appendChild(d);let o=t("DIV");o.innerHTML=l.text,n.appendChild(o),v.appendChild(n)}else if("@@HTMLSTART"===a.slice(0,11)){let e;for(h=!0,e=n+1;e<d.length&&"@@HTMLEND"!==d[e];e+=1){let t=d[e].replace(/\\"/g,'"');u.push(t)}}else if("@@HTMLEND"===a.slice(0,9)){h=!1;let e=t("DIV");e.classList.add("rawHTMLDiv");let i=u.join("");e.innerHTML=i,v.appendChild(e),u=[]}else if("@@IMG"===a.slice(0,5)){let e=a.slice(5).split(" "),i={};e.forEach(function(t,l){if(":source"===t)i.source=e[l+1];else if(":desc"===t){let t=e.slice(l);i.desc=t.join(" ")}});let l=t("IMG");l.classList.add("plainImage"),l.src=i.source,void 0!==i.desc?l.alt=i.desc:l.alt="An image for "+s.title,v.appendChild(l)}else if("@@ILLO"===a.slice(0,6)){e+=1;let n={},d=a.split(" ");!1===d.includes(":source")&&alert("required illustration data missing."),d.forEach(function(e,t){if(":source"===e)n.source=d[t+1];else if(":buy"===e)n.buy=d[t+1];else if(":caption"===e){let e=d.slice(t+1);e=(e=e.join(" ")).replace(/\\"/g,""),n.caption=e}else if(":orientation"===e)n.orientation=d[t+1];else if(":desc"===e)n.desc=d[t+1];else if(":illustrator"===e){let e,i="";for(e=t+1;e<d.length;e+=1)if(":"!==d[e].charAt(0))i=i.concat(" "+d[e]);else if(":"===d[e].charAt(0))break;n.illustrator=i}});let c="";c=e<10?"0"+e:e;let r=t("IMG");r.id="illustration"+c;let p={link:"#"+r.id};if(void 0===n.caption)p.text="Image No. "+(o.length+1);else{let e=n.caption;p.text=e}if(o.push(p),void 0!==n.desc&&""!==n.desc)r.title=n.desc,r.alt=n.desc;else{let e="Illustration for "+s.title;if(r.title=e,r.alt=e,void 0!==n.illustrator&&""!==n.illustrator){let e=" , illustration by "+n.illustrator;r.title=r.title.concat(e),r.alt=r.alt.concat(e)}}r.classList.add("illustrationTarget"),"portrait"===n.orientation?r.classList.add("thumbnailPortrait"):"landscape"===n.orientation&&r.classList.add("thumbnailLandscape"),r.src=n.source,v.appendChild(r);let h=t("IMG");h.classList.add("enlargeIcon"),h.alt="Click or tap to enlarge illustration",h.src="http://www.ndhfilms.com/assets/images/enlargeicon_black.svg",v.appendChild(h);let u=t("DIV");u.classList.add("illustrationDiv"),u.classList.add("standby"),l(u);let f=t("DIV");f.classList.add("container");let C=t("DIV");C.classList.add("flexbox1");let g=t("IMG");g.classList.add("illustration"),g.classList.add(n.orientation+"Illustration"),g.alt="Illustration for "+s.title+" by "+n.illustrator,g.title="Illustration by "+n.illustrator,g.src=n.source,C.appendChild(g),f.appendChild(C);let m=t("DIV");m.classList.add("illustrationCaptionDiv"),m.classList.add("flexbox2");let L=t("HGROUP");L.classList.add("illustrationCaption");let I=t("H2"),T=i("Image #"+o.length+" for this E-Book.");if(void 0!==n.caption&&(T=i(n.caption)),I.appendChild(T),L.appendChild(I),void 0!==n.illustrator){let e=t("H3"),l=i("Illustration by "+n.illustrator);e.appendChild(l),L.appendChild(e)}m.appendChild(L),f.appendChild(m),u.appendChild(f),v.appendChild(u)}else if("@@AUDIO"===a.slice(0,7)){let e={},t=a.slice(7).split(" ");t.forEach(function(i,l){if(":source"===i)e.source=t[l+1];else if(":title"===i){let i=t.slice(l+1).join(" ");e.title=i}}),r.push(e)}else if("#"===a.slice(0,1)){let e="",l="",s="";if("#"===a.charAt(0)&&"#"!==a.charAt(1)){e=t("H1");let i=(l=a.slice(1)).replace(" ","_");e.id=i;let o={link:"#"+i};void 0!==d[n+1]&&"##"===d[n+1].slice(0,2)&&(s=": "+d[n+1].slice(2)),o.text=l+s,c.push(o)}else"#"===a.charAt(0)&&"#"===a.charAt(1)&&(e=t("H2"),l=a.slice(2));e.classList="chapterHeading";let o=i(l);e.appendChild(o),v.appendChild(e)}else if("`"===a.slice(0,1)){let e=t("P");e.classList.add("lyricalP");let i=1;"``"===a.slice(0,2)&&(i=2,e.classList.add("endOfVerse")),e.innerHTML=a.slice(i).replace(/\\"/g,'"'),v.appendChild(e)}else if("@@DED"===a.slice(0,5)){let e=t("P");e.classList.add("dedication");let l=i(a.slice(5));e.appendChild(l),v.appendChild(e)}else if("@@FN"===a.slice(0,4)){let e=t("P"),i=a.slice(4),l=C.children.length+1,n="<a id='footnote"+l+"' href='#footnoteLink"+l+"'><sup>"+l+"</sup></a>"+i;e.innerHTML=n,C.appendChild(e)}else if(!1===h){let e=t("P"),i="";":left"===a.slice(0,5)?(e.classList.add("alignLeft"),i=(i=a.slice(5)).replace(/\\"/g,'"')):":center"===a.slice(0,7)?(e.classList.add("alignCenter"),i=(i=a.slice(7)).replace(/\\"/g,'"')):":right"===a.slice(0,6)?(e.classList.add("alignRight"),i=(i=a.slice(6)).replace(/\\"/g,'"')):i=a.replace(/\\"/g,'"'),g?(i="<span class='dropcap'>"+i.slice(0,1)+"</span>"+i.slice(1),e.innerHTML=i,g=!1):e.innerHTML=i,e.innerHTML.includes("<fn>")&&(f+=1,e.innerHTML=e.innerHTML.replace("<fn>","<a id='footnoteLink"+f+"' href='#footnote"+f+"'><sup>"+f+"</sup></a>")),v.appendChild(e)}})}(),function(){let e=t("LABEL");e.setAttribute("for","tocSelect");let a=i("Some text here");e.appendChild(a);let n=t("SELECT");n.id="tocSelect",n.classList.add("selectClosed");let d=t("OPTION");d.id="firstOption",d.value="placeholder";let r=i("TABLE OF CONTENTS");d.appendChild(r),n.appendChild(d);let p=t("DIV");p.id="tableOfContents",p.classList.add("tocStandby"),p.onclick=!0;let h=t("H1");h.classList.add("tocHeader");let u=i("TABLE OF CONTENTS");h.appendChild(u),p.appendChild(h);let f=t("DIV");f.id="tocMobileDiv";let C=t("UL");C.id="tocList",f.appendChild(C),p.appendChild(f);let g=t("SECTION");g.id="tableOfContentsSection";let m=t("H2"),L=i("TABLE OF CONTENTS");m.appendChild(L),g.appendChild(m);let I=t("UL");function T(e,l){if(e.length>0){let a=t("OPTION");a.value="placeholder";let d="ILLUSTRATIONS";"chapters"===l&&(d="SECTIONS");let s=i("-- "+d+" --");a.appendChild(s),n.appendChild(a);let o=t("LI");o.classList.add("listHeading");let c=t("H3"),r=i(d);c.appendChild(r),o.appendChild(c),C.appendChild(o);let p=t("LI");p.classList.add("listHeading");let h=t("H3"),u=i(d);h.appendChild(u),p.appendChild(h),I.appendChild(p),e.forEach(function(e,a){let d=t("OPTION");d.value=e.link;let s=i(e.text);d.appendChild(s),n.appendChild(d);let o=t("LI");"illustrations"===l&&"Cover"!==e.text&&o.classList.add("listItalic");let c=t("A");c.classList.add("tocLink"),c.href=e.link;let r=i(e.text);c.appendChild(r),o.appendChild(c),C.appendChild(o);let p=t("LI");"illustrations"===l&&"Cover"!==e.text&&p.classList.add("listItalic");let h=t("A");h.href=e.link;let u=i(e.text);h.appendChild(u),p.appendChild(h),I.appendChild(p)})}}T(o,"illustrations"),T(c,"chapters"),l(p,"tocCloseButton"),g.appendChild(I),(c.length>0||o.length>0)&&(v.appendChild(e),v.getElementsByTagName("HEADER")[0].parentNode.insertBefore(n,v.getElementsByTagName("HEADER")[0].nextSibling),v.getElementsByTagName("HEADER")[0].parentNode.insertBefore(p,v.getElementsByTagName("HEADER")[0].nextSibling),"small"!==s.small&&v.getElementsByTagName("HEADER")[0].parentNode.insertBefore(g,v.getElementsByTagName("HEADER")[0].nextSibling))}();let T=t("DIV");T.id="audioSourceMenu",T.classList.add("audioSourceMenuStandby");let b=t("HGROUP");if(""!==s.title){let e=t("H1"),l=i(s.title);if(e.appendChild(l),b.appendChild(e),""!==s.subtitle){let e=t("H2"),l=i(s.subtitle);e.appendChild(l),b.appendChild(e)}if(""!==s.author){let e=t("H3"),l="";l=""!==s.credit?i(s.credit+" "+s.author):i("by "+s.author),e.appendChild(l),b.appendChild(e)}}let E=t("H1");E.id="audioSourceMenuHeader";let y=i("CHOOSE AN AUDIO FILE");E.appendChild(y),b.appendChild(E),T.appendChild(b);let S=t("DIV");S.id="audioListDiv";let A=t("UL");if(A.id="audioSourceList",0===r.length)v.querySelector("#cassetteDiv").remove(),null!==v.querySelector("#audioDiv")&&v.querySelector("#audioDiv").remove();else{r.forEach(function(e){let l=t("LI");l.title=e.source;let a=i(e.title);l.appendChild(a),A.appendChild(l)});let e=t("P");e.id="currentAudio";let a="CHOOSE AN AUDIO FILE &#9757;";e.innerHTML=a,r.length>1&&(S.appendChild(A),T.appendChild(S),l(T)),v.querySelector("#audioCassetteDiv").insertBefore(e,v.querySelector("#audioCassetteDiv").childNodes[0]),v.insertBefore(T,v.querySelector("#audioDiv"))}if(""!==s.date&&function(){let e=t("UL");e.classList.add("mainTextUL"),e.id="endingDate";let l=t("LI"),a=i(s.location);l.appendChild(a);let n=t("LI"),d=s.date,o=d.split("-"),c=o[0],r=["January","February","March","April","May","June","July","August","September","October","November","December"][parseInt(o[1])-1],p=o[2];"0"===p.charAt(0)&&(p=p.slice(1)),p="1"===p||"21"===p||"31"===p?p.concat("<sup>st</sup>"):"2"===p||"22"===p?p.concat("<sup>nd</sup>"):"3"===p||"23"===p?p.concat("<sup>rd</sup>"):p.concat("<sup>th</sup>"),t("TIME").datetime=d,n.innerHTML=r+" "+p+", "+c,e.appendChild(l),e.appendChild(n),null!==v.querySelectorAll("#supportSection")?v.insertBefore(e,v.querySelectorAll("#supportSection")[0]):v.appendChild(e)}(),d.length>0&&function(){let e=t("P");if(e.id="copyrightNotice",e.classList.add("center"),""!==s.copyright){let t=s.copyright.split(" "),i=t[0],l="TEXT &COPY; ",a="<time datetime='"+i+"'>"+i+"</time>",n=t.slice(1).join(" ");e.innerHTML="PUBLIC"===i?"TEXT <s>&COPY;</s> PUBLIC DOMAIN":l+a+" "+n}else e.innerHTML="No copyright information available at this time";null!==v.querySelectorAll("#supportSection")?v.insertBefore(e,v.querySelectorAll("#supportSection")[0]):v.appendChild(e)}(),d.length>0&&function(){let e=t("SECTION");e.classList.add("endingSection"),e.id="creditsSection";let l=t("H3");l.classList.add("sectionHeader");let a=i("CREDITS");l.appendChild(a),e.appendChild(l);let n=t("UL");n.classList.add("mainTextUL"),n.id="creditsList";let d=t("LI"),o=i("Written by "+s.author);if(d.appendChild(o),n.appendChild(d),""!==s.coverart){let e=t("LI"),l=i("Cover Art by "+s.coverart);e.appendChild(l),n.appendChild(e)}if(""!==s.illustrator){let e=t("LI"),l=i("Illustrated by "+s.illustrator);e.appendChild(l),n.appendChild(e)}e.appendChild(n),v.appendChild(e)}(),function(){let e=t("P");e.id="eReaderNotice";let l=i("This e-Reader was developed by Nicholas Bernhard. No part of the source code or user interface can be used without explicit permission from the developer. For licensing information, send an email to Nicholas[at]NDHFilms[dot][com].");e.appendChild(l),v.appendChild(e)}(),C.children.length>0){let e=t("H3");e.classList.add("sectionHeader");let l=i("FOOTNOTES");e.appendChild(l),C.insertBefore(e,C.children[0]),v.insertBefore(C,v.querySelectorAll("#eReaderNotice")[0])}function O(e,l){let a=t("OPTION");a.value=e;let n=i(l);a.appendChild(n),void 0!==v.querySelectorAll("#tocSelect")[0]&&v.querySelectorAll("#tocSelect")[0].appendChild(a);let d=t("LI"),s=t("A");s.classList.add("tocLink"),s.href=e;let o=i(l);if(s.appendChild(o),d.appendChild(s),void 0!==v.querySelectorAll("#tocList")[0]&&v.querySelectorAll("#tocList")[0].appendChild(d),null!==v.querySelectorAll("#tableOfContentsSection")){let a=t("LI"),n=t("A");n.href=e;let d="";d=i("Back To Menu"===l?"-- BACK TO MENU --":l),n.appendChild(d),a.appendChild(n),void 0!==v.querySelectorAll("#tableOfContentsSection")[0]&&v.querySelectorAll("#tableOfContentsSection")[0].children[1].appendChild(a)}}if(void 0!==v.querySelectorAll("#supportSection")&&"object"!=typeof v.querySelectorAll("#supportSection")&&O("#supportSection",v.querySelectorAll("#supportSection")[0].children[0].innerText),null!==v.querySelectorAll("#creditsSection")&&d.length>0&&O("#creditsSection","CREDITS"),null!==v.querySelectorAll("#footnoteSection")&&d.length>0&&O("#footnoteSection","FOOTNOTES"),d.length>0&&O("#eReaderNotice","NDH E-READER COPYRIGHT NOTICE"),C.children.length>0&&O("#footnoteSection","Footnotes"),""!==s.menu&&O(s.menu,"Back to Menu"),""!==s.audio&&(v.querySelectorAll("#audioDivIllustration")[0].src=s.coverlink),function(){let e=t("SCRIPT");e.src="http://www.ndhfilms.com/assets/javascript/e-readerjs.js",v.appendChild(e)}(),0===d.length&&""===v.querySelectorAll("HEADER")[0].children[0].innerHTML){let e=t("H1");e.classList.add("chapterHeading");let l=i("GEE...");e.appendChild(l),v.insertBefore(e,v.querySelectorAll("#eReaderNotice")[0]);let a=t("P"),n=i("It sure is boring around here.");a.appendChild(n),v.insertBefore(a,v.querySelectorAll("#eReaderNotice")[0])}m.appendChild(v),function(i,l){let a=new Blob([l],{type:"text/html;charset=UTF-8"}),n=URL.createObjectURL(a),d="";!function(){let e=new Date,t=e.getFullYear()+"-",i=e.getMonth()+1;i<10&&(i="0"+i+"-");let l=e.getDate();l<10&&(l="0"+l),d=d.concat(t,i,l)}();let s=t("A"),o=i+"_"+d+".html";s.download=o,s.href=n,s.textContent=o,s.click(),e("inputOutputContainer").appendChild(s),e("inputOutputContainer").innerHTML=""}(localStorage.getItem("lastFileOpened"),"<!DOCTYPE html>"+L+m.innerHTML+"</html>")}